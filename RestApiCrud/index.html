<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="Style.css"> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">
    </script>
    <title>Php Crud Using Rest Api</title>
</head>
<body>
    
    <table width="100%" cellpadding="10px">
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>Age</th>
            <th>Gender</th>
            <th>Class</th>
        </tr>
        <tbody id="load-table">

        </tbody>
    </table>
    <div class="modal fade" id="modalLoginForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Update Record</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form action="" id="update-form">
      <div class="modal-body mx-3">
        <div class="md-form">          
          <label data-error="wrong" data-success="right" for="defaultForm-email">Name</label>
          <input type="text" id="edit-name" class="form-control validate">          
          <input type="number" id="edit-id" hidden>          
        </div>

        <div class="md-form">          
          <label data-error="wrong" data-success="right" for="defaultForm-pass">Age</label>
          <input type="number" id="edit-age" class="form-control validate">          
        </div>
        <div class="md-form">          
          <label data-error="wrong" data-success="right" for="defaultForm-pass">Gender</label>
          <input type="text" id="edit-gender" class="form-control validate">          
        </div>
        <div class="md-form">          
          <label data-error="wrong" data-success="right" for="defaultForm-pass">Class</label>
          <input type="text" id="edit-class" class="form-control validate">          
        </div>
      </div>
      <div class="modal-footer d-flex justify-content-center">
        <input value="update" class="btn btn-primary" type="submit" id="update-button">                
      </div>
    </form>
    </div>
  </div>
</div>

<form id="addform">
    Name : <input type="text" name="" id="">
    Age : <input type="text" name="" id="">
    Gender : <input type="text" name="" id="">
    Class : <input type="text" name="" id="">    
    <input type="submit" name="" id="add-button">
</form>

    <script type="text/javascript">
    
        $(document).ready(function(){
            function load_data(){
                $.ajax({
                    url : 'http://localhost/RestApiCrud/Fetch-api-readall.php',
                    type : "GET",
                    success : function(data){
                        if(data.status == false)
                        {
                            $("#load-table").append("<tr><td><h2>"+data.message+"</h2></td></tr>")
                        }
                        else{
                            $.each(data,function(key, value){
                                $("#load-table").append("<tr>"+"<td>"+ value.Sid +"</td>"+
                                "<td>"+ value.name +"</td>"+
                                "<td>"+ value.Age +"</td>"+
                                "<td>"+ value.Gender +"</td>"+
                                "<td>"+ value.Class +"</td>"+
                                "<td><button data-toggle='modal' data-target='#modalLoginForm'  class='btn btn-primary edit-btn' data-eid='"+value.Sid+"'>Edit</button></td>"+
                                "<td><button class='btn btn-primary' did='"+value.Sid+"'>Delete</button></td>"+
                                "</tr>");
                            });
                        }
                    }
                });
            }
            load_data();

            //add data

            $("#add-button").on("click",function(e){
             
              e.preventDefault(); //default submit features prevent
              var arr = $("#addform").serializeArray();
              console.log(arr);
            });

            //fetch single record
            $(document).on("click",".edit-btn",function(){
       //         $("#modalLoginForm").show();
                var student_id = $(this).data("eid");
                var obj = {Sid : student_id};
                var Json = JSON.stringify(obj);
                // console.log(Json);

                $.ajax({
                  url : 'http://localhost/RestApiCrud/Fetch-api-singleitem.php',
                  type : "POST",
                  data : Json,
                  success : function(data){
                    //  console.log(data);
                    $("#edit-id").val(data[0].Sid);
                    $("#edit-name").val(data[0].name);
                    $("#edit-age").val(data[0].Age);
                    $("#edit-gender").val(data[0].Gender);
                    $("#edit-class").val(data[0].Class);
                  }
                });

            });
        });
    </script>
</body>
</html>